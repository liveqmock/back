<%@ page language="java" import="java.util.*" pageEncoding="UTF-8" isELIgnored="false"%>
<%@ page contentType="text/html; charset=utf-8" %>
<%@ taglib prefix="s" uri="/struts-tags" %>
<div id="div_create_paybill" class="easyui-dialog" closed="true" modal="true" title="新建付款单" style="width:450px;height:350px;">
	
	<form id="createFormpaybill">
		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="1" class="gbox" style="font-size:12px; line-height:26px">	
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>认购或合同</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_confirmType" name="createPayBill.confirmType" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>主单id</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_mainId" name="createPayBill.mainId" required="required"  style="width:90px" class="easyui-numberbox" data-options="min:0,precision:0"/></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>开盘日期</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_startSaleDate" name="createPayBill.startSaleDate" required="required"  style="width:90px" class="easyui-datebox"/></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>单据类型</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_billType" name="createPayBill.billType" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>票据类型</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_paperType" name="createPayBill.paperType" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>票据编号</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_billNo" name="createPayBill.billNo" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>金额</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_payMoney" name="createPayBill.payMoney" required="required"  style="width:90px" class="easyui-numberbox" data-options="min:0,precision:2"/></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>交款人</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_payMan" name="createPayBill.payMan" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>开票人id</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_writerId" name="createPayBill.writerId" required="required"  style="width:90px" class="easyui-numberbox" data-options="min:0,precision:0"/></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>审核日期</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_approvalDate" name="createPayBill.approvalDate" required="required"  style="width:90px" class="easyui-datebox"/></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>状态</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_state" name="createPayBill.state" required="required"  style="width:90px" /></td>
			</tr>
			<tr  onMouseOver="this.style.backgroundColor='#f1f9fe'" onMouseOut="this.style.backgroundColor=''" bgcolor="#FFFFFF" style="empty-cells:show">
			<td id="t15" style="width:30%" align="center"><font color="#FF0000">*</font>备注</td>
			<td id="t16" style="width:70%">&nbsp;&nbsp;<input type="text" id="createPayBill_remark" name="createPayBill.remark" required="required"  style="width:90px" /></td>
			</tr>
		</table>
	</form>	
</div>



<script type="text/javascript">
//打开新建弹出窗口
function openDivCreatePayBill(){		
	$("#div_create_paybill").dialog({
		resizable: true,
		onClose:function(){			
			$('#createFormpaybill')[0].reset();
			
            //清理form中的所有填充值

			
			moduleMask("searchChipTableId");//遮罩层
			window.parent.refreshSelectedTab("chip_tabs");  //在easyui.utils.js中(刷新tab)
					
		},
		buttons:[{
			text:'提交',
			iconCls:'icon-ok',
			handler:function(){
				
				submitCreatePayBill(this);				
			}
		},
		{
			text:'关闭',
			iconCls:'icon-cancel',
			handler:function(){
				
				$('#div_create_paybill').dialog('close');
			}
		}]
	});
	
	$('#div_create_paybill').dialog('open');
	$('#div_create_paybill').dialog('setTitle', '新建付款单');
	
	return false;
}


//保存付款单
function submitCreatePayBill(dialogSaveButton){
    //做填充的验证
	//var chipCustomerName = $("#chipCustomerName").val();	
	//if(chipCustomerName == ""){		
	//	$("#chipCustomerName").focus();
	//	dialogNewSugg(dialogSaveButton, "客户名称不能为空");
	//	return false;
	//}	
	dialogNewSugg(dialogSaveButton, "提交中...");
	
	$.ajax({
		type:"post",
		url: "./demo/easyui/ajaxCreatePayBill.action",
		data: $("#createFormpaybill").serialize() ,
		dataType: "json",
		success: function(data){			
			//根据返回的类型type判断是否成功,message做为提示内容			
			var type = data.type;
			
			if(type == "true"){
				//保存成功				
				$('#createFormpaybill')[0].reset();	
				$('#div_create_paybill').dialog('close');
				
			}else{				
				//保存失败				
				var sugg = "<font color='red'>" + data.message + "</font>";
				dialogNewSugg(dialogSaveButton, sugg);
			}			
		}		
	});
}
</script>



